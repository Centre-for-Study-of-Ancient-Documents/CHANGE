{% extends 'base.html' %}
{% block content %}
<div class="row">
  <div class="col-md-9 order-md-2 mb-5" style="margin-top: 2rem !important;">
    <div class="row">
      <h1 class="row">
        <div class="col-2 d-block d-md-none d-lg-none">
          <button class="btn btn-primary" type="button" data-bs-toggle="offcanvas"
            data-bs-target="#offcanvasWithBothOptions" aria-controls="offcanvasWithBothOptions">
            <i class="fas fa-filter"></i>
          </button>
        </div>
        <div class="col-3 col-md-2">Results</div>
        <div class="col-6 col-md-4">
          <a id="btnMapResults" type="button" class="text-decoration-none fs-5" data-bs-toggle="modal"
            data-bs-target="#mapModal">
            Map Results
          </a>

          <!-- <a id="btnDownloadCSV" type="button" title="Download CSV" onclick="downloadCSV(this)"
            class="btn btn-sm btn-primary text-decoration-none ms-3">
            <i class="fas fa-download"></i> <i class="fas fa-file-csv"></i>
          </a> -->

          <div class="export btn-group">
            <button class="btn btn-primary btn-sm dropdown-toggle ms-3 btnSpinner" aria-label="Export data"
              data-bs-toggle="dropdown" type="button" title="Export data" aria-expanded="true">
              <i class="fas fa-download spinnerLoader"></i>
              <div class="spinner-border text-light spinner-border-sm d-none spinnerLoader" role="status">
                <span class="visually-hidden">Loading...</span>
              </div>
              <span class="caret"></span>
            </button>
            <div class="dropdown-menu dropdown-menu-end" data-popper-placement="bottom-end"
              style="position: absolute; inset: 0px 0px auto auto; margin: 0px; transform: translate3d(0.5px, 40px, 0px); cursor: pointer;">
              <span class="dropdown-item" onclick="downloadFile(this, 'csv')"><i class="fas fa-file-csv"></i> CSV</span>
              <span class="dropdown-item" onclick="downloadFile(this, 'xlsx')"><i class="fas fa-file-excel"></i> MS-Excel</span>
              <span class="dropdown-item" onclick="downloadFile(this, 'xml')"><i class="fas fa-file-alt"></i> XML</span>
              <span class="dropdown-item" onclick="downloadFile(this, 'json')"><i class="fas fa-file"></i> JSON</span>
            </div>
          </div>
        </div>
       
      </h1>
      <div class="col-md-12" id="divSelectedOptions" style="font-size: 14px;">
        
      </div>
    </div>
    {% if (res | length) > 0 %}
    <div class="paging_div row">
      {% include 'pagination.html' %}
    </div>
    {% else %}
    <h4>No records to show</h4>
    {% endif %}
    <!-- <div class="row">
      <div class="col-md-9">
        <form role="form" class="sortForm form-inline" action="results" method="GET">
          <div class="form-group">
            <select class="sortForm_categories form-select">
              <option value="null">Select from List</option>
            </select>
          </div>
          <div class="form-group">
            <select class="sortForm_order form-select">
              <option value="asc">Ascending</option>
              <option value="desc">Descending</option>
            </select>
          </div>
          <input type="hidden" name="q" value=""><input type="hidden" name="sort" value=""
            class="sort_param">
            <button class="btn btn-default sort_button" type="submit" disabled="">
              <span class="glyphicon glyphicon-sort-by-attributes"></span> Sort Results
            </button>
        </form>
      </div>
      <div class="col-md-3 pull-right text-right"><a class="btn btn-default" style="margin-right:10px"
          title="List layout" href="results?layout=grid" disabled="disabled"><span
            class="glyphicon glyphicon-th-list"></span></a><a class="btn btn-default" title="Grid layout"
          href="results?layout=grid"><span class="glyphicon glyphicon-th"></span></a></div>
    </div> -->
    {% for item in res %}
    <div class="row result-doc border-bottom mt-2">
      <div class="col-md-12">
        <h4><a class="text-decoration-none" href="/inscriptions/item/{{item.id}}">{{ item.city}}: {{item.date_from}} To
            {{item.date_to}} {{item.description}}</a></h4>
      </div>
      <div class="col-md-7 col-lg-8">
        <dl class="row">
          <dt class="col-md-2">Date</dt>
          <dd class="col-md-10">{{item.date_from}} To {{item.date_to}}</dd>
          <dt class="col-md-2">Region</dt>
          <dd class="col-md-10">{{item.region}}</dd>
          <!-- <dt class="col-md-2">Authority</dt>
          <dd class="col-md-10">{{ item.authority if item.authority else 'N/A'  }}</dd>
          <dt class="col-md-2">Activity</dt>
          <dd class="col-md-10">{{item.activity if item.activity else 'N/A'}}</dd> -->
          <dt class="col-md-2">Reference</dt>
          <dd class="col-md-10">{{item.reference_in_full}}</dd>
          <dt class="col-md-2">Bibliography</dt>
          <dd class="col-md-10"><a href="{{item.bib_url}}" target="_blank">{{item.bib_url}} <i
                class="fas fa-external-link-alt"></i></a></dd>
        </dl>
      </div>
    </div>
    {% endfor %}

    {% if (res | length) > 0 %}
    <div class="paging_div row mt-3 mb-5">
      {% include 'pagination.html' %}
    </div>
    {% endif %}
  </div>
  <div class="col-md-3 order-md-1 d-none d-sm-none d-md-block d-lg-block d-xl-block">
    {% include 'filters.html' %}
  </div>
  <div class="offcanvas offcanvas-start" data-bs-scroll="true" tabindex="-1" id="offcanvasWithBothOptions"
    aria-labelledby="offcanvasWithBothOptionsLabel">
    <div class="offcanvas-body">
      <button type="button" class="btn-close float-end" data-bs-dismiss="offcanvas" aria-label="Close"></button>
      {% include 'filters.html' %}
    </div>
  </div>
</div>

<!-- Modal -->
<div class="modal fade" id="mapModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
  aria-labelledby="staticBackdropLabel" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="staticBackdropLabel">Results on Map</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body content">
        <!-- Loader element -->
        <div id="divLoadingMap" class="overlay">
          <div class="overlay-content">
            <div class="spinner-border text-light" role="status">
              <span class="visually-hidden">Loading...</span>
            </div> Loading...
          </div>
        </div>
        <div id="mapGeneral" style="height: 60vh !important;"></div>
      </div>
    </div>
  </div>
</div>
{% endblock %}